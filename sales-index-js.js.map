{"version":3,"sources":["webpack:///./src/components/sortable-table/SalesSortableTable.js","webpack:///./src/pages/sales/sales-header.js","webpack:///./src/pages/sales/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/getFormattedNumber.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/range-picker/index.js"],"names":["SalesSortableTable","SortableTable","getBodyTemplate","data","map","item","this","getCellTemplate","join","header","id","title","sortable","sortType","template","value","date","Date","getMonth","getDate","getFullYear","price","getFormattedNumber","Page","render","wrapper","document","createElement","innerHTML","element","firstElementChild","subElements","getSubElements","initComponents","renderComponents","initEventListeners","querySelectorAll","reduce","accum","subElement","dataset","dateRange","from","setMonth","to","rangePicker","RangePicker","sortableTable","url","encodeURIComponent","components","key","component","Object","entries","append","addEventListener","event","detail","updateComponents","searchParams","set","fetchJson","update","remove","destroy","values","params","response","body","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","constructor","super","window","reason","alert","number","divider","arr","String","split","length","splice","step","start","isSortLocally","async","columnHeader","target","closest","order","orderToggle","asc","desc","arrow","sortParams","_sort","_order","sort","sortOnServer","isRequestSend","bottom","documentElement","getBoundingClientRect","clientHeight","_start","_end","loadData","addRows","URL","process","find","addListeners","getHeaderTemplate","getHeaderRowTemplate","getHeaderArrowTemplate","acc","classList","add","filterParams","query","assign","keys","makeSort","field","direction","a","b","localeCompare","caseFirst","sortedData","onHeaderPointerdown","onDocumentScroll","insertAdjacentHTML","removeEventListener","toLocaleString","dateStyle","isOpen","contains","isRangePicker","close","showDateFrom","selected","formatDate","input","selector","onDocumentClick","toggle","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","showDate1","showDate2","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","cellDate","toISOString","selectedFromElem","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles"],"mappings":"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","file":"sales-index-js.js","sourcesContent":["import SortableTable from './';\n\nexport default class SalesSortableTable extends SortableTable {\n  getBodyTemplate(data) {\n    return data\n      .map(item => {\n        return `\n          <div class=\"sortable-table__row\">\n            ${this.getCellTemplate(item)}\n          </div>\n        `;\n      })\n      .join('');\n  }\n}\n","import getFormattedNumber from '../../utils/getFormattedNumber.js';\n\nconst header = [\n  {\n    id: 'id',\n    title: 'ID',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'user',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'createdAt',\n    title: 'Date',\n    sortable: true,\n    sortType: 'date',\n    template: value => {\n      const months = [\n        'Jan',\n        'Feb',\n        'Mar',\n        'Apr',\n        'May',\n        'June',\n        'July',\n        'Aug',\n        'Sep',\n        'Oct',\n        'Nov',\n        'Dec'\n      ];\n      const date = new Date(value);\n\n      return `\n        <div class=\"sortable-table__cell\">\n          ${months[date.getMonth()]}\n          ${date.getDate()}\n          , ${date.getFullYear()}\n        </div>\n      `;\n    }\n  },\n  {\n    id: 'totalCost',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: price => `<div class=\"sortable-table__cell\">$${getFormattedNumber(price, ',')}</div>`\n  },\n  {\n    id: 'delivery',\n    title: 'Status',\n    sortable: true,\n    sortType: 'number'\n  }\n];\n\nexport default header;\n","import RangePicker from '../../components/range-picker';\nimport SortableTable from '../../components/sortable-table/SalesSortableTable.js';\nimport header from './sales-header.js';\nimport fetchJson from '../../utils/fetch-json.js';\n\nexport default class Page {\n  element;\n  subElements;\n  components;\n\n  get template() {\n    return `\n\t\t\t<div class=\"sales full-height flex-column\">\n\t\t\t\t<div class=\"content__top-panel\">\n\t\t\t\t\t<h1 class=\"page-title\">Sales</h1>\n\t\t\t\t\t<div data-element=\"rangePicker\" class=\"rangepicker\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div data-element=\"sortableTable\" class=\"full-height flex-column\"></div>\n\t\t\t</div>\n\t\t`;\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.template;\n    this.element = wrapper.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  initComponents() {\n    const dateRange = {\n      from: new Date(new Date().setMonth(new Date().getMonth() - 1)),\n      to: new Date()\n    };\n\n    const rangePicker = new RangePicker(dateRange);\n\n    const sortableTable = new SortableTable(header, {\n      url: `api/rest/orders?createdAt_gte=${encodeURIComponent(\n        dateRange.from\n      )}&createdAt_lte${encodeURIComponent(dateRange.to)}`\n    });\n\n    this.components = {\n      rangePicker,\n      sortableTable\n    };\n  }\n\n  renderComponents() {\n    for (const [key, component] of Object.entries(this.components)) {\n      const container = this.subElements[key];\n\n      container.append(component.element);\n    }\n  }\n\n  initEventListeners() {\n    this.subElements.rangePicker.addEventListener('date-select', event => {\n      const { from, to } = event.detail;\n\n      this.updateComponents(from, to);\n    });\n  }\n\n  async updateComponents(from, to) {\n    const url = this.components.sortableTable.url;\n\n    url.searchParams.set('createdAt_gte', from);\n    url.searchParams.set('createdAt_lte', to);\n\n    const data = await fetchJson(url);\n\n    this.components.sortableTable.update(data);\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function (url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch (err) {\n    throw new FetchError(response, 'Network error has occurred.');\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText =\n        (body.error && body.error.message) ||\n        (body.data && body.data.error && body.data.error.message) ||\n        errorText;\n    } catch (error) {\n      /* ignore failed body */\n    }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch (err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = 'FetchError';\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n","export default function (number, divider) {\n  const arr = String(number).split('');\n\n  if (arr.length > 3 && arr.length <= 6) {\n    arr.splice(-3, 0, divider);\n  } else if (arr.length > 6) {\n    arr.splice(-3, 0, divider);\n    arr.splice(-7, 0, divider);\n  }\n\n  return `${arr.join('')}`;\n}\n","import fetchJson from '../../utils/fetch-json.js';\n\nexport default class SortableTable {\n  element;\n  subElements = {};\n  data = [];\n  sortParams = {};\n  filterParams = {};\n  isSortLocally = false;\n  isRequestSend = false;\n\n  onHeaderPointerdown = async event => {\n    const columnHeader = event.target.closest('.sortable-table__cell');\n    const { id, order, sortable } = columnHeader.dataset;\n\n    if (sortable === 'false') return;\n\n    const orderToggle = {\n      asc: 'desc',\n      desc: 'asc'\n    };\n\n    columnHeader.dataset.order = orderToggle[order];\n    columnHeader.append(this.subElements.arrow);\n\n    this.sortParams._sort = id;\n    this.sortParams._order = orderToggle[order];\n\n    if (this.isSortLocally) {\n      this.sort(this.sortParams._sort, this.sortParams._order);\n    } else {\n      this.sortOnServer();\n    }\n  };\n\n  onDocumentScroll = async () => {\n    if (this.isRequestSend || this.isSortLocally) return;\n\n    const { bottom } = document.documentElement.getBoundingClientRect();\n    const htmlHeight = document.documentElement.clientHeight;\n    const gap = 200;\n\n    if (bottom < htmlHeight + gap) {\n      this.isRequestSend = true;\n      this.sortParams._start += this.step;\n      this.sortParams._end += this.step;\n\n      const data = await this.loadData();\n\n      this.addRows(data);\n      this.isRequestSend = false;\n    }\n  };\n\n  constructor(header = [], { url = '', step = 30, start = 0, isSortLocally = false } = {}) {\n    this.header = header;\n    this.url = new URL(url, process.env.BACKEND_URL);\n    this.step = step;\n    this.sortParams._sort = header.find(item => item.sortable).id;\n    this.sortParams._order = 'asc';\n    this.sortParams._start = start;\n    this.sortParams._end = start + step;\n    this.isSortLocally = isSortLocally;\n\n    this.render();\n    this.addListeners();\n  }\n\n  get template() {\n    return `\n      <div class=\"sortable-table\">\n\n        <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\n          ${this.getHeaderTemplate()}\n        </div>\n\n        <div data-element=\"body\" class=\"sortable-table__body\">\n          ${this.getBodyTemplate(this.data)}\n        </div>\n\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\n          <div>\n            <p>No products found matching the selected criteria</p>\n            <button data-element=\"reset\" type=\"button\" class=\"button-primary-outline\">Clear filters</button>\n          </div>\n        </div>\n\n      </div>\n    `;\n  }\n\n  getHeaderTemplate() {\n    return this.header.map(item => this.getHeaderRowTemplate(item)).join('');\n  }\n\n  getHeaderRowTemplate({ id, title, sortable }) {\n    return `\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" ${\n      sortable ? 'data-order=\"asc\"' : ''\n    }>\n        <span>${title}</span>\n        ${this.getHeaderArrowTemplate(id)}\n      </div>\n    `;\n  }\n\n  getHeaderArrowTemplate(id) {\n    const template = `\n      <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n        <span class=\"sort-arrow\"></span>\n      </span>\n    `;\n\n    return id === this.sortParams._sort ? template : '';\n  }\n\n  getBodyTemplate(data) {\n    return data\n      .map(item => {\n        return `\n          <a href=\"/products/${item.id}\" class=\"sortable-table__row\">\n            ${this.getCellTemplate(item)}\n          </a>\n        `;\n      })\n      .join('');\n  }\n\n  getCellTemplate(item) {\n    return this.header\n      .map(({ id, template }) => {\n        if (id === 'images' && !item[id].length) {\n          return `\n            <div class=\"sortable-table__cell\">\n              <img class=\"sortable-table-image\" alt=\"no-image\" src=\"#\">\n            </div>\n          `;\n        } else if (template) {\n          return template(item[id]);\n        } else {\n          return `<div class=\"sortable-table__cell\">${item[id]}</div>`;\n        }\n      })\n      .join('');\n  }\n\n  async render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((acc, subElement) => {\n      acc[subElement.dataset.element] = subElement;\n\n      return acc;\n    }, {});\n  }\n\n  async loadData(params) {\n    this.element.classList.add('sortable-table_loading');\n\n    if (params) {\n      this.filterParams = params;\n    }\n\n    const url = new URL(this.url);\n    const query = Object.assign({}, this.filterParams, this.sortParams);\n\n    for (const key of Object.keys(query)) {\n      url.searchParams.set(key, query[key]);\n    }\n\n    const data = await fetchJson(url);\n\n    this.element.classList.remove('sortable-table_loading');\n\n    return data;\n  }\n\n  update(data) {\n    if (data.length) {\n      this.subElements.body.innerHTML = this.getBodyTemplate(data);\n      this.data = data;\n      this.element.classList.remove('sortable-table_empty');\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  makeSort(field, order) {\n    const arr = [...this.data];\n    const { sortType } = this.header.find(item => item.id === field);\n    const direction = order === 'asc' ? 1 : -1;\n\n    return arr.sort((a, b) => {\n      switch (sortType) {\n        case 'string':\n          return direction * a[field].localeCompare(b[field], ['ru', 'en'], { caseFirst: 'upper' });\n        case 'number':\n          return direction * (a[field] - b[field]);\n        default:\n          return direction * (a[field] - b[field]);\n      }\n    });\n  }\n\n  sort(field, order) {\n    const sortedData = this.makeSort(field, order);\n\n    this.subElements.body.innerHTML = this.getBodyTemplate(sortedData);\n  }\n\n  async sortOnServer() {\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  addListeners() {\n    this.subElements.header.addEventListener('click', this.onHeaderPointerdown);\n    document.addEventListener('scroll', this.onDocumentScroll);\n  }\n\n  addRows(data) {\n    this.subElements.body.insertAdjacentHTML('beforeend', this.getBodyTemplate(data));\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n    this.subElements = {};\n    document.removeEventListener('scroll', this.onDocumentScroll);\n  }\n}\n","export default class RangePicker {\n  element = null;\n  subElements = {};\n  selectingFrom = true;\n  selected = {\n    from: new Date(),\n    to: new Date()\n  };\n\n  static formatDate(date) {\n    return date.toLocaleString('ru', { dateStyle: 'short' });\n  }\n\n  onDocumentClick = event => {\n    const isOpen = this.element.classList.contains('rangepicker_open');\n    const isRangePicker = this.element.contains(event.target);\n\n    if (isOpen && !isRangePicker) {\n      this.close();\n    }\n  };\n\n  constructor({ from = new Date(), to = new Date() } = {}) {\n    this.showDateFrom = new Date(from);\n    this.selected = { from, to };\n\n    this.render();\n  }\n\n  get template() {\n    const from = RangePicker.formatDate(this.selected.from);\n    const to = RangePicker.formatDate(this.selected.to);\n\n    return `<div class=\"rangepicker\">\n      <div class=\"rangepicker__input\" data-element=\"input\">\n        <span data-element=\"from\">${from}</span> -\n        <span data-element=\"to\">${to}</span>\n      </div>\n      <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\n    </div>`;\n  }\n\n  render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(element);\n\n    this.initEventListeners();\n  }\n\n  getSubElements(element) {\n    const subElements = {};\n\n    for (const subElement of element.querySelectorAll('[data-element]')) {\n      subElements[subElement.dataset.element] = subElement;\n    }\n\n    return subElements;\n  }\n\n  initEventListeners() {\n    const { input, selector } = this.subElements;\n\n    document.addEventListener('click', this.onDocumentClick, true);\n    input.addEventListener('click', () => this.toggle());\n    selector.addEventListener('click', event => this.onSelectorClick(event));\n  }\n\n  toggle() {\n    this.element.classList.toggle('rangepicker_open');\n    this.renderDateRangePicker();\n  }\n\n  onSelectorClick({ target }) {\n    if (target.classList.contains('rangepicker__cell')) {\n      this.onRangePickerCellClick(target);\n    }\n  }\n\n  close() {\n    this.element.classList.remove('rangepicker_open');\n  }\n\n  renderDateRangePicker() {\n    const showDate1 = new Date(this.showDateFrom);\n    const showDate2 = new Date(this.showDateFrom);\n    const { selector } = this.subElements;\n\n    showDate2.setMonth(showDate2.getMonth() + 1);\n\n    selector.innerHTML = `\n      <div class=\"rangepicker__selector-arrow\"></div>\n      <div class=\"rangepicker__selector-control-left\"></div>\n      <div class=\"rangepicker__selector-control-right\"></div>\n      ${this.renderCalendar(showDate1)}\n      ${this.renderCalendar(showDate2)}\n    `;\n\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\n\n    controlLeft.addEventListener('click', () => this.prev());\n    controlRight.addEventListener('click', () => this.next());\n\n    this.renderHighlight();\n  }\n\n  prev() {\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\n    this.renderDateRangePicker();\n  }\n\n  next() {\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\n    this.renderDateRangePicker();\n  }\n\n  renderHighlight() {\n    const { from, to } = this.selected;\n\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\n      const { value } = cell.dataset;\n      const cellDate = new Date(value);\n\n      cell.classList.remove('rangepicker__selected-from');\n      cell.classList.remove('rangepicker__selected-between');\n      cell.classList.remove('rangepicker__selected-to');\n\n      if (from && value === from.toISOString()) {\n        cell.classList.add('rangepicker__selected-from');\n      } else if (to && value === to.toISOString()) {\n        cell.classList.add('rangepicker__selected-to');\n      } else if (from && to && cellDate >= from && cellDate <= to) {\n        cell.classList.add('rangepicker__selected-between');\n      }\n    }\n\n    if (from) {\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\n      if (selectedFromElem) {\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\n      }\n    }\n\n    if (to) {\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\n      if (selectedToElem) {\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\n      }\n    }\n  }\n\n  renderCalendar(showDate) {\n    const date = new Date(showDate);\n    const getGridStartIndex = dayIndex => {\n      const index = dayIndex === 0 ? 6 : dayIndex - 1; // make Sunday (0) the last day\n      return index + 1;\n    };\n\n    date.setDate(1);\n\n    // text-transform: capitalize\n    const monthStr = date.toLocaleString('ru', { month: 'long' });\n\n    let table = `<div class=\"rangepicker__calendar\">\n      <div class=\"rangepicker__month-indicator\">\n        <time datetime=${monthStr}>${monthStr}</time>\n      </div>\n      <div class=\"rangepicker__day-of-week\">\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\n      </div>\n      <div class=\"rangepicker__date-grid\">\n    `;\n\n    // first day of month starts after a space\n    // * * * 1 2 3 4\n    table += `\n      <button type=\"button\"\n        class=\"rangepicker__cell\"\n        data-value=\"${date.toISOString()}\"\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\n          ${date.getDate()}\n      </button>`;\n\n    date.setDate(2);\n\n    while (date.getMonth() === showDate.getMonth()) {\n      table += `\n        <button type=\"button\"\n          class=\"rangepicker__cell\"\n          data-value=\"${date.toISOString()}\">\n            ${date.getDate()}\n        </button>`;\n\n      date.setDate(date.getDate() + 1);\n    }\n\n    // close the table\n    table += '</div></div>';\n\n    return table;\n  }\n\n  onRangePickerCellClick(target) {\n    const { value } = target.dataset;\n\n    if (value) {\n      const dateValue = new Date(value);\n\n      if (this.selectingFrom) {\n        this.selected = {\n          from: dateValue,\n          to: null\n        };\n        this.selectingFrom = false;\n        this.renderHighlight();\n      } else {\n        if (dateValue > this.selected.from) {\n          this.selected.to = dateValue;\n        } else {\n          this.selected.to = this.selected.from;\n          this.selected.from = dateValue;\n        }\n\n        this.selectingFrom = true;\n        this.renderHighlight();\n      }\n\n      if (this.selected.from && this.selected.to) {\n        this.dispatchEvent();\n        this.close();\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to);\n      }\n    }\n  }\n\n  dispatchEvent() {\n    this.element.dispatchEvent(\n      new CustomEvent('date-select', {\n        bubbles: true,\n        detail: this.selected\n      })\n    );\n  }\n\n  remove() {\n    this.element.remove();\n    // TODO: Warning! To remove listener MUST be passes the same event phase\n    document.removeEventListener('click', this.onDocumentClick, true);\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    this.selectingFrom = true;\n    this.selected = {\n      from: new Date(),\n      to: new Date()\n    };\n\n    return this;\n  }\n}\n"],"sourceRoot":""}