{"version":3,"sources":["webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/getFormattedNumber.js","webpack:///./src/components/sortable-table/index.js"],"names":["DoubleSlider","onThumbPointerDown","event","thumbElem","target","preventDefault","left","right","getBoundingClientRect","this","subElements","thumbLeft","shiftX","clientX","dragging","element","classList","add","document","addEventListener","onThumbPointerMove","onThumbPointerUp","constructor","min","max","formatValue","value","selected","from","to","innerLeft","innerRight","width","inner","newLeft","parseFloat","thumbRight","style","progress","innerHTML","getValue","newRight","remove","removeEventListener","dispatchEvent","CustomEvent","detail","bubbles","render","createElement","template","firstElementChild","ondragstart","getSubElements","initEventListeners","update","querySelectorAll","reduce","accum","subElement","dataset","rangeTotal","Math","round","floor","reset","destroy","header","id","title","sortable","data","url","sortType","category","price","getFormattedNumber","Page","filterName","filterStatus","components","doubleSlider","updateComponents","async","table","sortableTable","loadData","params","wrapper","initComponents","renderComponents","SortableTable","key","component","Object","entries","append","onResetPointerdown","length","status","values","response","body","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","Error","super","window","reason","alert","number","divider","arr","String","split","splice","join","step","start","isSortLocally","columnHeader","closest","order","orderToggle","asc","desc","arrow","sortParams","_sort","_order","sort","sortOnServer","isRequestSend","bottom","documentElement","clientHeight","_start","_end","addRows","URL","process","find","item","addListeners","getHeaderTemplate","getBodyTemplate","map","getHeaderRowTemplate","getHeaderArrowTemplate","getCellTemplate","acc","filterParams","query","assign","keys","searchParams","set","fetchJson","makeSort","field","direction","a","b","localeCompare","caseFirst","sortedData","onHeaderPointerdown","onDocumentScroll","insertAdjacentHTML"],"mappings":"+QAAe,MAAMA,EAInBC,mBAAmBC,GACjB,MAAMC,EAAYD,EAAME,OAExBF,EAAMG,iBAEN,MAAM,KAAEC,EAAF,MAAQC,GAAUJ,EAAUK,wBAE9BL,IAAcM,KAAKC,YAAYC,UACjCF,KAAKG,OAASL,EAAQL,EAAMW,QAE5BJ,KAAKG,OAASN,EAAOJ,EAAMW,QAG7BJ,KAAKK,SAAWX,EAEhBM,KAAKM,QAAQC,UAAUC,IAAI,yBAE3BC,SAASC,iBAAiB,cAAeV,KAAKW,oBAC9CF,SAASC,iBAAiB,YAAaV,KAAKY,kBA6D9CC,aAAY,IACVC,EAAM,IADI,IAEVC,EAAM,IAFI,YAGVC,EAAcC,IAAS,IAAMA,GAHnB,SAIVC,EAAW,CACTC,KAAML,EACNM,GAAIL,IAEJ,IAAI,8CAzFM,IAyFN,4BAlEatB,IACnBA,EAAMG,iBAEN,MACEC,KAAMwB,EACNvB,MAAOwB,EAFH,MAGJC,GACEvB,KAAKC,YAAYuB,MAAMzB,wBAE3B,GAAIC,KAAKK,WAAaL,KAAKC,YAAYC,UAAW,CAChD,IAAIuB,GAAWhC,EAAMW,QAAUiB,EAAYrB,KAAKG,QAAUoB,EAEtDE,EAAU,IACZA,EAAU,GAEZA,GAAW,IACX,MAAM3B,EAAQ4B,WAAW1B,KAAKC,YAAY0B,WAAWC,MAAM9B,OAEvD2B,EAAU3B,EAAQ,MACpB2B,EAAU,IAAM3B,GAGlBE,KAAKK,SAASuB,MAAM/B,KAAOG,KAAKC,YAAY4B,SAASD,MAAM/B,KAAO4B,EAAU,IAC5EzB,KAAKC,YAAYkB,KAAKW,UAAY9B,KAAKgB,YAAYhB,KAAK+B,WAAWZ,MAGrE,GAAInB,KAAKK,WAAaL,KAAKC,YAAY0B,WAAY,CACjD,IAAIK,GAAYV,EAAa7B,EAAMW,QAAUJ,KAAKG,QAAUoB,EAExDS,EAAW,IACbA,EAAW,GAEbA,GAAY,IAEZ,MAAMnC,EAAO6B,WAAW1B,KAAKC,YAAYC,UAAU0B,MAAM/B,MAErDA,EAAOmC,EAAW,MACpBA,EAAW,IAAMnC,GAEnBG,KAAKK,SAASuB,MAAM9B,MAAQE,KAAKC,YAAY4B,SAASD,MAAM9B,MAAQkC,EAAW,IAC/EhC,KAAKC,YAAYmB,GAAGU,UAAY9B,KAAKgB,YAAYhB,KAAK+B,WAAWX,OA0B7D,0BAtBW,KACjBpB,KAAKM,QAAQC,UAAU0B,OAAO,yBAE9BxB,SAASyB,oBAAoB,cAAelC,KAAKW,oBACjDF,SAASyB,oBAAoB,YAAalC,KAAKY,kBAE/CZ,KAAKM,QAAQ6B,cACX,IAAIC,YAAY,eAAgB,CAC9BC,OAAQrC,KAAK+B,WACbO,SAAS,OAcbtC,KAAKc,IAAMA,EACXd,KAAKe,IAAMA,EACXf,KAAKgB,YAAcA,EACnBhB,KAAKkB,SAAWA,EAEhBlB,KAAKuC,SAGK,eACV,MAAM,KAAEpB,EAAF,GAAQC,GAAOpB,KAAKkB,SAE1B,MAAQ,+DACsBlB,KAAKgB,YAAYG,0WAMnBnB,KAAKgB,YAAYI,wBAI/CmB,SACE,MAAMjC,EAAUG,SAAS+B,cAAc,OAEvClC,EAAQwB,UAAY9B,KAAKyC,SAEzBzC,KAAKM,QAAUA,EAAQoC,kBACvB1C,KAAKM,QAAQqC,YAAc,KAAM,EAEjC3C,KAAKC,YAAcD,KAAK4C,eAAetC,GAEvCN,KAAK6C,qBAEL7C,KAAK8C,SAGPF,eAAetC,GAGb,MAAO,IAFUA,EAAQyC,iBAAiB,mBAErBC,OAAO,CAACC,EAAOC,KAClCD,EAAMC,EAAWC,QAAQ7C,SAAW4C,EAE7BD,GACN,IAGLlB,WACE,MAAMqB,EAAapD,KAAKe,IAAMf,KAAKc,KAC7B,KAAEjB,GAASG,KAAKC,YAAYC,UAAU0B,OACtC,MAAE9B,GAAUE,KAAKC,YAAY0B,WAAWC,MAK9C,MAAO,CAAET,KAHIkC,KAAKC,MAAMtD,KAAKc,IAAyB,IAAnBY,WAAW7B,GAAeuD,GAG9ChC,GAFJiC,KAAKC,MAAMtD,KAAKe,IAA0B,IAApBW,WAAW5B,GAAgBsD,IAK9DN,SACE,MAAMM,EAAapD,KAAKe,IAAMf,KAAKc,IAC7BjB,EAAOwD,KAAKE,OAAQvD,KAAKkB,SAASC,KAAOnB,KAAKc,KAAOsC,EAAc,KAAO,IAC1EtD,EAAQuD,KAAKE,OAAQvD,KAAKe,IAAMf,KAAKkB,SAASE,IAAMgC,EAAc,KAAO,IAE/EpD,KAAKC,YAAY4B,SAASD,MAAM/B,KAAOA,EACvCG,KAAKC,YAAY4B,SAASD,MAAM9B,MAAQA,EAExCE,KAAKC,YAAYC,UAAU0B,MAAM/B,KAAOA,EACxCG,KAAKC,YAAY0B,WAAWC,MAAM9B,MAAQA,EAG5C0D,QACExD,KAAKkB,SAASC,KAAOnB,KAAKc,IAC1Bd,KAAKkB,SAASE,GAAKpB,KAAKe,IACxBf,KAAK8C,SACL9C,KAAKC,YAAYkB,KAAKW,UAAY9B,KAAKgB,YAAYhB,KAAK+B,WAAWZ,MACnEnB,KAAKC,YAAYmB,GAAGU,UAAY9B,KAAKgB,YAAYhB,KAAK+B,WAAWX,IAGnEyB,qBACE,MAAM,UAAE3C,EAAF,WAAayB,GAAe3B,KAAKC,YAEvCC,EAAUQ,iBAAiB,cAAejB,GAASO,KAAKR,mBAAmBC,IAC3EkC,EAAWjB,iBAAiB,cAAejB,GAASO,KAAKR,mBAAmBC,IAG9EwC,SACEjC,KAAKM,QAAQ2B,SAGfwB,UACEzD,KAAKiC,SACLxB,SAASyB,oBAAoB,cAAelC,KAAKW,oBACjDF,SAASyB,oBAAoB,YAAalC,KAAKY,mB,YCnIpC8C,MAnDA,CACb,CACEC,GAAI,SACJC,MAAO,QACPC,UAAU,EACVpB,SAAUqB,GACA,kHAEmDA,EAAK,GAAGC,qCAKvE,CACEJ,GAAI,QACJC,MAAO,OACPC,UAAU,EACVG,SAAU,UAEZ,CACEL,GAAI,cACJC,MAAO,WACPC,UAAU,EACVpB,SAAUwB,GAAa,qCAAoCA,EAASL,eAEtE,CACED,GAAI,WACJC,MAAO,WACPC,UAAU,EACVG,SAAU,UAEZ,CACEL,GAAI,QACJC,MAAO,QACPC,UAAU,EACVG,SAAU,SACVvB,SAAUyB,GAAU,sCAAqCC,YAAmBD,EAAO,cAErF,CACEP,GAAI,SACJC,MAAO,SACPC,UAAU,EACVG,SAAU,SACVvB,SAAUqB,GACA,iDACFA,EAAO,EAAI,SAAW,+B,6HC1CnB,MAAMM,EAAK,4DAEV,IAFU,oBAGX,IAHW,4BAKH,KACnBpE,KAAKC,YAAYoE,WAAWpD,MAAQ,GACpCjB,KAAKC,YAAYqE,aAAarD,MAAQ,GACtCjB,KAAKuE,WAAWC,aAAahB,QAC7BxD,KAAKyE,qBATiB,0BAyHLC,UACjB,MAAMC,EAAQ3E,KAAKuE,WAAWK,cACxBd,QAAaa,EAAME,SAAS7E,KAAK8E,QAEvCH,EAAM7B,OAAOgB,KAjHH,eACV,MAAQ,8qCAkCVvB,SACE,MAAMwC,EAAUtE,SAAS+B,cAAc,OAUvC,OARAuC,EAAQjD,UAAY9B,KAAKyC,SACzBzC,KAAKM,QAAUyE,EAAQrC,kBACvB1C,KAAKC,YAAcD,KAAK4C,eAAe5C,KAAKM,SAE5CN,KAAKgF,iBACLhF,KAAKiF,mBACLjF,KAAK6C,qBAEE7C,KAAKM,QAGdsC,eAAetC,GAGb,MAAO,IAFUA,EAAQyC,iBAAiB,mBAErBC,OAAO,CAACC,EAAOC,KAClCD,EAAMC,EAAWC,QAAQ7C,SAAW4C,EAE7BD,GACN,IAGL+B,iBACE,MAAMJ,EAAgB,IAAIM,IAAcxB,EAAQ,CAC9CK,IAAK,kDAGDS,EAAe,IAAIjF,EAAa,CAAEuB,IAAK,EAAGC,IAAK,MAErDf,KAAKuE,WAAa,CAChBK,gBACAJ,gBAIJS,mBACE,IAAK,MAAOE,EAAKC,KAAcC,OAAOC,QAAQtF,KAAKuE,YAAa,CAC5CvE,KAAKC,YAAYkF,GAEzBI,OAAOH,EAAU9E,UAI/BuC,qBACE7C,KAAKuE,WAAWK,cAAc3E,YAAYuD,MAAM9C,iBAC9C,cACAV,KAAKwF,oBAEPxF,KAAKC,YAAYuE,aAAa9D,iBAAiB,eAAgBV,KAAKyE,kBACpEzE,KAAKC,YAAYoE,WAAW3D,iBAAiB,QAASV,KAAKyE,kBAC3DzE,KAAKC,YAAYqE,aAAa5D,iBAAiB,QAASV,KAAKyE,kBAGrD,aACR,MAAMJ,EAAarE,KAAKC,YAAYoE,WAAWpD,MACzCqD,EAAetE,KAAKC,YAAYqE,aAAarD,MAC7C6D,EAAS,CACb,UAAe9E,KAAKuE,WAAWC,aAAazC,WAAWZ,KACvD,UAAenB,KAAKuE,WAAWC,aAAazC,WAAWX,IAWzD,OARIiD,IACFS,EAAM,WAAiBT,GAGrBC,EAAamB,SACfX,EAAOY,OAASpB,GAGXQ,EAUT7C,SACEjC,KAAKM,QAAQ2B,SAGfwB,UACE,IAAK,MAAM2B,KAAaC,OAAOM,OAAO3F,KAAKuE,YACzCa,EAAU3B,UAGZzD,KAAKiC,Y,+BC1IM,mBAAgB8B,EAAKe,GAClC,IAAIc,EASAC,EAPJ,IAEED,QAAiBE,MAAM/B,EAAIgC,WAAYjB,GACvC,MAAOkB,GACP,MAAM,IAAIC,EAAWL,EAAU,+BAKjC,IAAKA,EAASM,GAAI,CAChB,IAAIC,EAAYP,EAASQ,WAEzB,IACEP,QAAaD,EAASS,OAEtBF,EACGN,EAAKS,OAAST,EAAKS,MAAMC,SACzBV,EAAK/B,MAAQ+B,EAAK/B,KAAKwC,OAAST,EAAK/B,KAAKwC,MAAMC,SACjDJ,EACF,MAAOG,IAIT,IAAIC,EAAW,SAAQX,EAASF,WAAWS,IAE3C,MAAM,IAAIF,EAAWL,EAAUC,EAAMU,GAGvC,IACE,aAAaX,EAASS,OACtB,MAAOL,GACP,MAAM,IAAIC,EAAWL,EAAU,KAAMI,EAAIO,WAItC,MAAMN,UAAmBO,MAG9B3F,YAAY+E,EAAUC,EAAMU,G,UAC1BE,MAAMF,G,EAHD,c,EAE8B,U,EAAA,M,sFAEnCvG,KAAK4F,SAAWA,EAChB5F,KAAK6F,KAAOA,GAKhBa,OAAOhG,iBAAiB,qBAAsBjB,IACxCA,EAAMkH,kBAAkBV,GAC1BW,MAAMnH,EAAMkH,OAAOJ,Y,6BCvDR,aAAUM,EAAQC,GAC/B,MAAMC,EAAMC,OAAOH,GAAQI,MAAM,IASjC,OAPIF,EAAItB,OAAS,GAAKsB,EAAItB,QAAU,EAClCsB,EAAIG,QAAQ,EAAG,EAAGJ,GACTC,EAAItB,OAAS,IACtBsB,EAAIG,QAAQ,EAAG,EAAGJ,GAClBC,EAAIG,QAAQ,EAAG,EAAGJ,IAGZ,GAAEC,EAAII,KAAK,M,kMCRN,MAAMjC,EAoDnBrE,YAAY6C,EAAS,IAAI,IAAEK,EAAM,GAAR,KAAYqD,EAAO,GAAnB,MAAuBC,EAAQ,EAA/B,cAAkCC,GAAgB,GAAU,IAAI,8CAlD3E,IAkD2E,cAjDlF,IAiDkF,oBAhD5E,IAgD4E,sBA/C1E,IA+C0E,wBA9CzE,GA8CyE,wBA7CzE,GA6CyE,6BA3CnE5C,UACpB,MAAM6C,EAAe9H,EAAME,OAAO6H,QAAQ,0BACpC,GAAE7D,EAAF,MAAM8D,EAAN,SAAa5D,GAAa0D,EAAapE,QAE7C,GAAiB,UAAbU,EAAsB,OAE1B,MAAM6D,EAAc,CAClBC,IAAK,OACLC,KAAM,OAGRL,EAAapE,QAAQsE,MAAQC,EAAYD,GACzCF,EAAahC,OAAOvF,KAAKC,YAAY4H,OAErC7H,KAAK8H,WAAWC,MAAQpE,EACxB3D,KAAK8H,WAAWE,OAASN,EAAYD,GAEjCzH,KAAKsH,cACPtH,KAAKiI,KAAKjI,KAAK8H,WAAWC,MAAO/H,KAAK8H,WAAWE,QAEjDhI,KAAKkI,iBAuBgF,0BAnBtExD,UACjB,GAAI1E,KAAKmI,eAAiBnI,KAAKsH,cAAe,OAE9C,MAAM,OAAEc,GAAW3H,SAAS4H,gBAAgBtI,wBAI5C,GAAIqI,EAHe3H,SAAS4H,gBAAgBC,aAChC,IAEmB,CAC7BtI,KAAKmI,eAAgB,EACrBnI,KAAK8H,WAAWS,QAAUvI,KAAKoH,KAC/BpH,KAAK8H,WAAWU,MAAQxI,KAAKoH,KAE7B,MAAMtD,QAAa9D,KAAK6E,WAExB7E,KAAKyI,QAAQ3E,GACb9D,KAAKmI,eAAgB,KAKvBnI,KAAK0D,OAASA,EACd1D,KAAK+D,IAAM,IAAI2E,IAAI3E,EAAK4E,oCACxB3I,KAAKoH,KAAOA,EACZpH,KAAK8H,WAAWC,MAAQrE,EAAOkF,KAAKC,GAAQA,EAAKhF,UAAUF,GAC3D3D,KAAK8H,WAAWE,OAAS,MACzBhI,KAAK8H,WAAWS,OAASlB,EACzBrH,KAAK8H,WAAWU,KAAOnB,EAAQD,EAC/BpH,KAAKsH,cAAgBA,EAErBtH,KAAKuC,SACLvC,KAAK8I,eAGK,eACV,MAAQ,6IAIA9I,KAAK+I,oHAIL/I,KAAKgJ,gBAAgBhJ,KAAK8D,+cAgBpCiF,oBACE,OAAO/I,KAAK0D,OAAOuF,IAAIJ,GAAQ7I,KAAKkJ,qBAAqBL,IAAO1B,KAAK,IAGvE+B,sBAAqB,GAAEvF,EAAF,MAAMC,EAAN,SAAaC,IAChC,MAAQ,sDACuCF,qBAAsBE,MACnEA,EAAW,mBAAqB,sBAEtBD,qBACN5D,KAAKmJ,uBAAuBxF,yBAKpCwF,uBAAuBxF,GAOrB,OAAOA,IAAO3D,KAAK8H,WAAWC,MANZ,wIAM+B,GAGnDiB,gBAAgBlF,GACd,OAAOA,EACJmF,IAAIJ,GACK,kCACeA,EAAKlF,iDACtB3D,KAAKoJ,gBAAgBP,gCAI5B1B,KAAK,IAGViC,gBAAgBP,GACd,OAAO7I,KAAK0D,OACTuF,IAAI,EAAGtF,KAAIlB,cACC,WAAPkB,GAAoBkF,EAAKlF,GAAI8B,OAMtBhD,EACFA,EAASoG,EAAKlF,IAEb,qCAAoCkF,EAAKlF,WARzC,6JAWXwD,KAAK,IAGE,eACV,MAAM7G,EAAUG,SAAS+B,cAAc,OAEvClC,EAAQwB,UAAY9B,KAAKyC,SACzBzC,KAAKM,QAAUA,EAAQoC,kBACvB1C,KAAKC,YAAcD,KAAK4C,eAAe5C,KAAKM,SAE5C,MAAMwD,QAAa9D,KAAK6E,WAExB7E,KAAK8C,OAAOgB,GAGdlB,eAAetC,GAGb,MAAO,IAFUA,EAAQyC,iBAAiB,mBAErBC,OAAO,CAACqG,EAAKnG,KAChCmG,EAAInG,EAAWC,QAAQ7C,SAAW4C,EAE3BmG,GACN,IAGS,eAACvE,GACb9E,KAAKM,QAAQC,UAAUC,IAAI,0BAEvBsE,IACF9E,KAAKsJ,aAAexE,GAGtB,MAAMf,EAAM,IAAI2E,IAAI1I,KAAK+D,KACnBwF,EAAQlE,OAAOmE,OAAO,GAAIxJ,KAAKsJ,aAActJ,KAAK8H,YAExD,IAAK,MAAM3C,KAAOE,OAAOoE,KAAKF,GAC5BxF,EAAI2F,aAAaC,IAAIxE,EAAKoE,EAAMpE,IAGlC,MAAMrB,QAAa8F,YAAU7F,GAI7B,OAFA/D,KAAKM,QAAQC,UAAU0B,OAAO,0BAEvB6B,EAGThB,OAAOgB,GACDA,EAAK2B,QACPzF,KAAKC,YAAY4F,KAAK/D,UAAY9B,KAAKgJ,gBAAgBlF,GACvD9D,KAAK8D,KAAOA,EACZ9D,KAAKM,QAAQC,UAAU0B,OAAO,yBAE9BjC,KAAKM,QAAQC,UAAUC,IAAI,wBAI/BqJ,SAASC,EAAOrC,GACd,MAAMV,EAAM,IAAI/G,KAAK8D,OACf,SAAEE,GAAahE,KAAK0D,OAAOkF,KAAKC,GAAQA,EAAKlF,KAAOmG,GACpDC,EAAsB,QAAVtC,EAAkB,GAAK,EAEzC,OAAOV,EAAIkB,KAAK,CAAC+B,EAAGC,KAClB,OAAQjG,GACN,IAAK,SACH,OAAO+F,EAAYC,EAAEF,GAAOI,cAAcD,EAAEH,GAAQ,CAAC,KAAM,MAAO,CAAEK,UAAW,UACjF,IAAK,SAEL,QACE,OAAOJ,GAAaC,EAAEF,GAASG,EAAEH,OAKzC7B,KAAK6B,EAAOrC,GACV,MAAM2C,EAAapK,KAAK6J,SAASC,EAAOrC,GAExCzH,KAAKC,YAAY4F,KAAK/D,UAAY9B,KAAKgJ,gBAAgBoB,GAGvC,qBAChB,MAAMtG,QAAa9D,KAAK6E,WAExB7E,KAAK8C,OAAOgB,GAGdgF,eACE9I,KAAKC,YAAYyD,OAAOhD,iBAAiB,QAASV,KAAKqK,qBACvD5J,SAASC,iBAAiB,SAAUV,KAAKsK,kBAG3C7B,QAAQ3E,GACN9D,KAAKC,YAAY4F,KAAK0E,mBAAmB,YAAavK,KAAKgJ,gBAAgBlF,IAG7E7B,SACEjC,KAAKM,QAAQ2B,SAGfwB,UACEzD,KAAKiC,SACLjC,KAAKC,YAAc,GACnBQ,SAASyB,oBAAoB,SAAUlC,KAAKsK","file":"products-list-index-js.js","sourcesContent":["export default class DoubleSlider {\n  element;\n  subElements = {};\n\n  onThumbPointerDown(event) {\n    const thumbElem = event.target;\n\n    event.preventDefault();\n\n    const { left, right } = thumbElem.getBoundingClientRect();\n\n    if (thumbElem === this.subElements.thumbLeft) {\n      this.shiftX = right - event.clientX;\n    } else {\n      this.shiftX = left - event.clientX;\n    }\n\n    this.dragging = thumbElem;\n\n    this.element.classList.add('range-slider_dragging');\n\n    document.addEventListener('pointermove', this.onThumbPointerMove);\n    document.addEventListener('pointerup', this.onThumbPointerUp);\n  }\n\n  onThumbPointerMove = event => {\n    event.preventDefault();\n\n    const {\n      left: innerLeft,\n      right: innerRight,\n      width\n    } = this.subElements.inner.getBoundingClientRect();\n\n    if (this.dragging === this.subElements.thumbLeft) {\n      let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\n\n      if (newLeft < 0) {\n        newLeft = 0;\n      }\n      newLeft *= 100;\n      const right = parseFloat(this.subElements.thumbRight.style.right);\n\n      if (newLeft + right > 100) {\n        newLeft = 100 - right;\n      }\n\n      this.dragging.style.left = this.subElements.progress.style.left = newLeft + '%';\n      this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\n    }\n\n    if (this.dragging === this.subElements.thumbRight) {\n      let newRight = (innerRight - event.clientX - this.shiftX) / width;\n\n      if (newRight < 0) {\n        newRight = 0;\n      }\n      newRight *= 100;\n\n      const left = parseFloat(this.subElements.thumbLeft.style.left);\n\n      if (left + newRight > 100) {\n        newRight = 100 - left;\n      }\n      this.dragging.style.right = this.subElements.progress.style.right = newRight + '%';\n      this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\n    }\n  };\n\n  onThumbPointerUp = () => {\n    this.element.classList.remove('range-slider_dragging');\n\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\n\n    this.element.dispatchEvent(\n      new CustomEvent('range-select', {\n        detail: this.getValue(),\n        bubbles: true\n      })\n    );\n  };\n\n  constructor({\n    min = 100,\n    max = 200,\n    formatValue = value => '$' + value,\n    selected = {\n      from: min,\n      to: max\n    }\n  } = {}) {\n    this.min = min;\n    this.max = max;\n    this.formatValue = formatValue;\n    this.selected = selected;\n\n    this.render();\n  }\n\n  get template() {\n    const { from, to } = this.selected;\n\n    return `<div class=\"range-slider\">\n      <span data-element=\"from\">${this.formatValue(from)}</span>\n      <div data-element=\"inner\" class=\"range-slider__inner\">\n        <span data-element=\"progress\" class=\"range-slider__progress\"></span>\n        <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\n        <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\n      </div>\n      <span data-element=\"to\">${this.formatValue(to)}</span>\n    </div>`;\n  }\n\n  render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.element.ondragstart = () => false;\n\n    this.subElements = this.getSubElements(element);\n\n    this.initEventListeners();\n\n    this.update();\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  getValue() {\n    const rangeTotal = this.max - this.min;\n    const { left } = this.subElements.thumbLeft.style;\n    const { right } = this.subElements.thumbRight.style;\n\n    const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\n    const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\n\n    return { from, to };\n  }\n\n  update() {\n    const rangeTotal = this.max - this.min;\n    const left = Math.floor(((this.selected.from - this.min) / rangeTotal) * 100) + '%';\n    const right = Math.floor(((this.max - this.selected.to) / rangeTotal) * 100) + '%';\n\n    this.subElements.progress.style.left = left;\n    this.subElements.progress.style.right = right;\n\n    this.subElements.thumbLeft.style.left = left;\n    this.subElements.thumbRight.style.right = right;\n  }\n\n  reset() {\n    this.selected.from = this.min;\n    this.selected.to = this.max;\n    this.update();\n    this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\n    this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\n  }\n\n  initEventListeners() {\n    const { thumbLeft, thumbRight } = this.subElements;\n\n    thumbLeft.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n    thumbRight.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\n  }\n}\n","import getFormattedNumber from '../../../utils/getFormattedNumber.js';\n\nconst header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      return `\n          <div class=\"sortable-table__cell\">\n            <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\n          </div>\n        `;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Category',\n    sortable: false,\n    template: category => `<div class=\"sortable-table__cell\">${category.title}</div>`\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: price => `<div class=\"sortable-table__cell\">$${getFormattedNumber(price, ',')}</div>`\n  },\n  {\n    id: 'status',\n    title: 'Status',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n          ${data > 0 ? 'Active' : 'Inactive'}\n        </div>`;\n    }\n  }\n];\n\nexport default header;\n","import SortableTable from '../../../components/sortable-table';\nimport DoubleSlider from '../../../components/double-slider';\nimport header from './products-header.js';\nimport fetchJson from '../../../utils/fetch-json.js';\n\nexport default class Page {\n  element;\n  subElements = {};\n  components = {};\n\n  onResetPointerdown = () => {\n    this.subElements.filterName.value = '';\n    this.subElements.filterStatus.value = '';\n    this.components.doubleSlider.reset();\n    this.updateComponents();\n  };\n\n  get template() {\n    return `\n\t\t\t<div class=\"products-list\">\n\t\t\t\t<div class=\"content__top-panel\">\n\t\t\t\t\t<h1 class=\"page-title\">Products</h1>\n\t\t\t\t\t<a href=\"/products/add\" class=\"button-primary\">Add product</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"content-box content-box_small\">\n\t\t\t\t\t<form class=\"form-inline\">\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t  <label class=\"form-label\">Sort by:</label>\n            \t<input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Product name\">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div data-element=\"doubleSlider\" class=\"form-group\">\n              <label class=\"form-label\">Price:</label>\n            </div>\n\n\t\t\t\t\t\t<div class=\"form-group\">\n            \t<label class=\"form-label\">Status:</label>\n            \t<select class=\"form-control\" data-element=\"filterStatus\">\n              \t<option value=\"\" selected=\"\">Any</option>\n              \t<option value=\"1\">Active</option>\n              \t<option value=\"0\">Inactive</option>\n            \t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\n\t\t\t\t<div data-element=\"sortableTable\" class=\"products-list__container\"></div>\n\t\t\t</div>\n\t\t`;\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.template;\n    this.element = wrapper.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  initComponents() {\n    const sortableTable = new SortableTable(header, {\n      url: 'api/rest/products?_embed=subcategory.category'\n    });\n\n    const doubleSlider = new DoubleSlider({ min: 0, max: 4000 });\n\n    this.components = {\n      sortableTable,\n      doubleSlider\n    };\n  }\n\n  renderComponents() {\n    for (const [key, component] of Object.entries(this.components)) {\n      const container = this.subElements[key];\n\n      container.append(component.element);\n    }\n  }\n\n  initEventListeners() {\n    this.components.sortableTable.subElements.reset.addEventListener(\n      'pointerdown',\n      this.onResetPointerdown\n    );\n    this.subElements.doubleSlider.addEventListener('range-select', this.updateComponents);\n    this.subElements.filterName.addEventListener('input', this.updateComponents);\n    this.subElements.filterStatus.addEventListener('input', this.updateComponents);\n  }\n\n  get params() {\n    const filterName = this.subElements.filterName.value;\n    const filterStatus = this.subElements.filterStatus.value;\n    const params = {\n      ['price_gte']: this.components.doubleSlider.getValue().from,\n      ['price_lte']: this.components.doubleSlider.getValue().to\n    };\n\n    if (filterName) {\n      params['title_like'] = filterName;\n    }\n\n    if (filterStatus.length) {\n      params.status = filterStatus;\n    }\n\n    return params;\n  }\n\n  updateComponents = async () => {\n    const table = this.components.sortableTable;\n    const data = await table.loadData(this.params);\n\n    table.update(data);\n  };\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n\n    this.remove();\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function (url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch (err) {\n    throw new FetchError(response, 'Network error has occurred.');\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText =\n        (body.error && body.error.message) ||\n        (body.data && body.data.error && body.data.error.message) ||\n        errorText;\n    } catch (error) {\n      /* ignore failed body */\n    }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch (err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = 'FetchError';\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n","export default function (number, divider) {\n  const arr = String(number).split('');\n\n  if (arr.length > 3 && arr.length <= 6) {\n    arr.splice(-3, 0, divider);\n  } else if (arr.length > 6) {\n    arr.splice(-3, 0, divider);\n    arr.splice(-7, 0, divider);\n  }\n\n  return `${arr.join('')}`;\n}\n","import fetchJson from '../../utils/fetch-json.js';\n\nexport default class SortableTable {\n  element;\n  subElements = {};\n  data = [];\n  sortParams = {};\n  filterParams = {};\n  isSortLocally = false;\n  isRequestSend = false;\n\n  onHeaderPointerdown = async event => {\n    const columnHeader = event.target.closest('.sortable-table__cell');\n    const { id, order, sortable } = columnHeader.dataset;\n\n    if (sortable === 'false') return;\n\n    const orderToggle = {\n      asc: 'desc',\n      desc: 'asc'\n    };\n\n    columnHeader.dataset.order = orderToggle[order];\n    columnHeader.append(this.subElements.arrow);\n\n    this.sortParams._sort = id;\n    this.sortParams._order = orderToggle[order];\n\n    if (this.isSortLocally) {\n      this.sort(this.sortParams._sort, this.sortParams._order);\n    } else {\n      this.sortOnServer();\n    }\n  };\n\n  onDocumentScroll = async () => {\n    if (this.isRequestSend || this.isSortLocally) return;\n\n    const { bottom } = document.documentElement.getBoundingClientRect();\n    const htmlHeight = document.documentElement.clientHeight;\n    const gap = 200;\n\n    if (bottom < htmlHeight + gap) {\n      this.isRequestSend = true;\n      this.sortParams._start += this.step;\n      this.sortParams._end += this.step;\n\n      const data = await this.loadData();\n\n      this.addRows(data);\n      this.isRequestSend = false;\n    }\n  };\n\n  constructor(header = [], { url = '', step = 30, start = 0, isSortLocally = false } = {}) {\n    this.header = header;\n    this.url = new URL(url, process.env.BACKEND_URL);\n    this.step = step;\n    this.sortParams._sort = header.find(item => item.sortable).id;\n    this.sortParams._order = 'asc';\n    this.sortParams._start = start;\n    this.sortParams._end = start + step;\n    this.isSortLocally = isSortLocally;\n\n    this.render();\n    this.addListeners();\n  }\n\n  get template() {\n    return `\n      <div class=\"sortable-table\">\n\n        <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\n          ${this.getHeaderTemplate()}\n        </div>\n\n        <div data-element=\"body\" class=\"sortable-table__body\">\n          ${this.getBodyTemplate(this.data)}\n        </div>\n\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\n          <div>\n            <p>No products found matching the selected criteria</p>\n            <button data-element=\"reset\" type=\"button\" class=\"button-primary-outline\">Clear filters</button>\n          </div>\n        </div>\n\n      </div>\n    `;\n  }\n\n  getHeaderTemplate() {\n    return this.header.map(item => this.getHeaderRowTemplate(item)).join('');\n  }\n\n  getHeaderRowTemplate({ id, title, sortable }) {\n    return `\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" ${\n      sortable ? 'data-order=\"asc\"' : ''\n    }>\n        <span>${title}</span>\n        ${this.getHeaderArrowTemplate(id)}\n      </div>\n    `;\n  }\n\n  getHeaderArrowTemplate(id) {\n    const template = `\n      <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n        <span class=\"sort-arrow\"></span>\n      </span>\n    `;\n\n    return id === this.sortParams._sort ? template : '';\n  }\n\n  getBodyTemplate(data) {\n    return data\n      .map(item => {\n        return `\n          <a href=\"/products/${item.id}\" class=\"sortable-table__row\">\n            ${this.getCellTemplate(item)}\n          </a>\n        `;\n      })\n      .join('');\n  }\n\n  getCellTemplate(item) {\n    return this.header\n      .map(({ id, template }) => {\n        if (id === 'images' && !item[id].length) {\n          return `\n            <div class=\"sortable-table__cell\">\n              <img class=\"sortable-table-image\" alt=\"no-image\" src=\"#\">\n            </div>\n          `;\n        } else if (template) {\n          return template(item[id]);\n        } else {\n          return `<div class=\"sortable-table__cell\">${item[id]}</div>`;\n        }\n      })\n      .join('');\n  }\n\n  async render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((acc, subElement) => {\n      acc[subElement.dataset.element] = subElement;\n\n      return acc;\n    }, {});\n  }\n\n  async loadData(params) {\n    this.element.classList.add('sortable-table_loading');\n\n    if (params) {\n      this.filterParams = params;\n    }\n\n    const url = new URL(this.url);\n    const query = Object.assign({}, this.filterParams, this.sortParams);\n\n    for (const key of Object.keys(query)) {\n      url.searchParams.set(key, query[key]);\n    }\n\n    const data = await fetchJson(url);\n\n    this.element.classList.remove('sortable-table_loading');\n\n    return data;\n  }\n\n  update(data) {\n    if (data.length) {\n      this.subElements.body.innerHTML = this.getBodyTemplate(data);\n      this.data = data;\n      this.element.classList.remove('sortable-table_empty');\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  makeSort(field, order) {\n    const arr = [...this.data];\n    const { sortType } = this.header.find(item => item.id === field);\n    const direction = order === 'asc' ? 1 : -1;\n\n    return arr.sort((a, b) => {\n      switch (sortType) {\n        case 'string':\n          return direction * a[field].localeCompare(b[field], ['ru', 'en'], { caseFirst: 'upper' });\n        case 'number':\n          return direction * (a[field] - b[field]);\n        default:\n          return direction * (a[field] - b[field]);\n      }\n    });\n  }\n\n  sort(field, order) {\n    const sortedData = this.makeSort(field, order);\n\n    this.subElements.body.innerHTML = this.getBodyTemplate(sortedData);\n  }\n\n  async sortOnServer() {\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  addListeners() {\n    this.subElements.header.addEventListener('click', this.onHeaderPointerdown);\n    document.addEventListener('scroll', this.onDocumentScroll);\n  }\n\n  addRows(data) {\n    this.subElements.body.insertAdjacentHTML('beforeend', this.getBodyTemplate(data));\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n    this.subElements = {};\n    document.removeEventListener('scroll', this.onDocumentScroll);\n  }\n}\n"],"sourceRoot":""}