{"version":3,"sources":["webpack:///./src/components/column-chart/index.js","webpack:///./src/pages/dashboard/bestsellers-header.js","webpack:///./src/pages/dashboard/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/getFormattedNumber.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/range-picker/index.js"],"names":["ColumnChart","constructor","label","link","formatHeading","data","url","range","from","Date","to","this","URL","process","render","element","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","loadData","getHeaderValue","Object","values","reduce","accum","item","classList","add","header","textContent","body","searchParams","set","toISOString","fetchJson","setNewRange","length","getColumnBody","remove","maxValue","Math","max","entries","map","key","value","scale","chartHeight","percent","toFixed","tooltip","toLocaleString","dateStyle","floor","join","getLink","querySelectorAll","subElement","dataset","destroy","id","title","sortable","sortType","category","price","getFormattedNumber","Page","wrapper","initComponents","renderComponents","initEventListeners","dateRange","setMonth","getMonth","rangePicker","RangePicker","ordersChart","salesChart","customersChart","sortableTable","SortableTable","encodeURIComponent","step","start","isSortLocally","components","component","append","update","addEventListener","event","detail","updateComponents","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","alert","number","divider","arr","String","split","splice","async","columnHeader","target","closest","order","orderToggle","asc","desc","arrow","sortParams","_sort","_order","sort","sortOnServer","isRequestSend","bottom","documentElement","getBoundingClientRect","clientHeight","_start","_end","addRows","find","addListeners","getHeaderTemplate","getBodyTemplate","getHeaderRowTemplate","getHeaderArrowTemplate","getCellTemplate","acc","filterParams","query","assign","keys","makeSort","field","direction","a","b","localeCompare","caseFirst","sortedData","onHeaderPointerdown","onDocumentScroll","insertAdjacentHTML","removeEventListener","date","isOpen","contains","isRangePicker","close","showDateFrom","selected","formatDate","input","selector","onDocumentClick","toggle","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","showDate1","showDate2","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","cellDate","selectedFromElem","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","getDate","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles"],"mappings":"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","file":"dashboard-index-js.js","sourcesContent":["import fetchJson from '../../utils/fetch-json.js';\n\nexport default class ColumnChart {\n  element;\n  subElements = {};\n  chartHeight = 50;\n\n  constructor({\n    label = '',\n    link = '',\n    formatHeading = data => data,\n    url = '',\n    range = {\n      from: new Date(),\n      to: new Date()\n    }\n  } = {}) {\n    this.url = new URL(url, process.env.BACKEND_URL);\n    this.range = range;\n    this.label = label;\n    this.link = link;\n    this.formatHeading = formatHeading;\n\n    this.render();\n  }\n\n  render() {\n    const { from, to } = this.range;\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.loadData(from, to);\n  }\n\n  getHeaderValue(data) {\n    return this.formatHeading(Object.values(data).reduce((accum, item) => accum + item, 0));\n  }\n\n  async loadData(from, to) {\n    this.element.classList.add('column-chart_loading');\n    this.subElements.header.textContent = '';\n    this.subElements.body.innerHTML = '';\n\n    this.url.searchParams.set('from', from.toISOString());\n    this.url.searchParams.set('to', to.toISOString());\n\n    const data = await fetchJson(this.url);\n\n    this.setNewRange(from, to);\n\n    if (data && Object.values(data).length) {\n      this.subElements.header.textContent = this.getHeaderValue(data);\n      this.subElements.body.innerHTML = this.getColumnBody(data);\n\n      this.element.classList.remove('column-chart_loading');\n    }\n  }\n\n  setNewRange(from, to) {\n    this.range.from = from;\n    this.range.to = to;\n  }\n\n  getColumnBody(data) {\n    const maxValue = Math.max(...Object.values(data));\n\n    return Object.entries(data)\n      .map(([key, value]) => {\n        const scale = this.chartHeight / maxValue;\n        const percent = ((value / maxValue) * 100).toFixed(0);\n        const tooltip = `<span>\n        <small>${key.toLocaleString('default', { dateStyle: 'medium' })}</small>\n        <br>\n        <strong>${percent}%</strong>\n      </span>`;\n\n        return `<div style=\"--value: ${Math.floor(\n          value * scale\n        )}\" data-tooltip=\"${tooltip}\"></div>`;\n      })\n      .join('');\n  }\n\n  getLink() {\n    return this.link ? `<a class=\"column-chart__link\" href=\"${this.link}\">View all</a>` : '';\n  }\n\n  get template() {\n    return `\n      <div class=\"column-chart dashboard__chart_${\n        this.label\n      } column-chart_loading\" style=\"--chart-height: ${this.chartHeight}\">\n        <div class=\"column-chart__title\">\n          Total ${this.label}\n          ${this.getLink()}\n        </div>\n        <div class=\"column-chart__container\">\n          <div data-element=\"header\" class=\"column-chart__header\"></div>\n          <div data-element=\"body\" class=\"column-chart__chart\"></div>\n        </div>\n      </div>\n    `;\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  async update(from, to) {\n    return await this.loadData(from, to);\n  }\n\n  destroy() {\n    this.element.remove();\n  }\n}\n","import getFormattedNumber from '../../utils/getFormattedNumber.js';\n\nconst header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      return `\n          <div class=\"sortable-table__cell\">\n            <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\n          </div>\n        `;\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Category',\n    sortable: false,\n    template: category => `<div class=\"sortable-table__cell\">${category.title}</div>`\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number',\n    template: price => `<div class=\"sortable-table__cell\">$${getFormattedNumber(price, ',')}</div>`\n  },\n  {\n    id: 'sales',\n    title: 'Sales',\n    sortable: true,\n    sortType: 'number'\n  }\n];\n\nexport default header;\n","import RangePicker from '../../components/range-picker/index.js';\nimport SortableTable from '../../components/sortable-table/index.js';\nimport ColumnChart from '../../components/column-chart/index.js';\nimport header from './bestsellers-header.js';\n\nimport fetchJson from '../../utils/fetch-json.js';\nimport getFormattedNumber from '../../utils/getFormattedNumber.js';\n\nexport default class Page {\n  element;\n  subElements;\n  components;\n\n  get template() {\n    return `\n      <div class=\"dashboard full-height flex-column\">\n\n        <div class=\"content__top-panel\">\n          <h2 class=\"page-title\">Dashboard</h2>\n          <div data-element=\"rangePicker\"></div>\n        </div>\n\n        <div class=\"dashboard__charts\">\n          <div data-element=\"ordersChart\"></div>\n          <div data-element=\"salesChart\"></div>\n          <div data-element=\"customersChart\"></div>\n        </div>\n        <h3 class=\"block-title\">Sales leaders</h3>\n        <div data-element=\"sortableTable\"></div>\n\n      </div>\n    `;\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.template;\n    this.element = wrapper.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    this.initComponents();\n    this.renderComponents();\n    this.initEventListeners();\n\n    return this.element;\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  initComponents() {\n    const dateRange = {\n      from: new Date(new Date().setMonth(new Date().getMonth() - 1)),\n      to: new Date()\n    };\n\n    const rangePicker = new RangePicker(dateRange);\n\n    const ordersChart = new ColumnChart({\n      url: 'api/dashboard/orders',\n      range: dateRange,\n      label: 'orders',\n      link: '#'\n    });\n\n    const salesChart = new ColumnChart({\n      url: 'api/dashboard/sales',\n      range: dateRange,\n      label: 'sales',\n      formatHeading: data => `$${getFormattedNumber(data, ',')}`\n    });\n\n    const customersChart = new ColumnChart({\n      url: 'api/dashboard/customers',\n      range: dateRange,\n      label: 'customers'\n    });\n\n    const sortableTable = new SortableTable(header, {\n      url: `api/dashboard/bestsellers?from=${encodeURIComponent(\n        dateRange.from\n      )}&to${encodeURIComponent(dateRange.to)}`,\n      step: 30,\n      start: 1,\n      isSortLocally: true\n    });\n\n    this.components = {\n      rangePicker,\n      ordersChart,\n      salesChart,\n      customersChart,\n      sortableTable\n    };\n  }\n\n  renderComponents() {\n    for (const [key, component] of Object.entries(this.components)) {\n      const container = this.subElements[key];\n\n      container.append(component.element);\n    }\n  }\n\n  async updateComponents(from, to) {\n    const url = this.components.sortableTable.url;\n\n    url.searchParams.set('from', from);\n    url.searchParams.set('to', to);\n\n    const data = await fetchJson(url);\n\n    this.components.sortableTable.update(data);\n    this.components.ordersChart.update(from, to);\n    this.components.salesChart.update(from, to);\n    this.components.customersChart.update(from, to);\n  }\n\n  initEventListeners() {\n    this.subElements.rangePicker.addEventListener('date-select', event => {\n      const { from, to } = event.detail;\n\n      this.updateComponents(from, to);\n    });\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function (url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch (err) {\n    throw new FetchError(response, 'Network error has occurred.');\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText =\n        (body.error && body.error.message) ||\n        (body.data && body.data.error && body.data.error.message) ||\n        errorText;\n    } catch (error) {\n      /* ignore failed body */\n    }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch (err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = 'FetchError';\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n","export default function (number, divider) {\n  const arr = String(number).split('');\n\n  if (arr.length > 3 && arr.length <= 6) {\n    arr.splice(-3, 0, divider);\n  } else if (arr.length > 6) {\n    arr.splice(-3, 0, divider);\n    arr.splice(-7, 0, divider);\n  }\n\n  return `${arr.join('')}`;\n}\n","import fetchJson from '../../utils/fetch-json.js';\n\nexport default class SortableTable {\n  element;\n  subElements = {};\n  data = [];\n  sortParams = {};\n  filterParams = {};\n  isSortLocally = false;\n  isRequestSend = false;\n\n  onHeaderPointerdown = async event => {\n    const columnHeader = event.target.closest('.sortable-table__cell');\n    const { id, order, sortable } = columnHeader.dataset;\n\n    if (sortable === 'false') return;\n\n    const orderToggle = {\n      asc: 'desc',\n      desc: 'asc'\n    };\n\n    columnHeader.dataset.order = orderToggle[order];\n    columnHeader.append(this.subElements.arrow);\n\n    this.sortParams._sort = id;\n    this.sortParams._order = orderToggle[order];\n\n    if (this.isSortLocally) {\n      this.sort(this.sortParams._sort, this.sortParams._order);\n    } else {\n      this.sortOnServer();\n    }\n  };\n\n  onDocumentScroll = async () => {\n    if (this.isRequestSend || this.isSortLocally) return;\n\n    const { bottom } = document.documentElement.getBoundingClientRect();\n    const htmlHeight = document.documentElement.clientHeight;\n    const gap = 200;\n\n    if (bottom < htmlHeight + gap) {\n      this.isRequestSend = true;\n      this.sortParams._start += this.step;\n      this.sortParams._end += this.step;\n\n      const data = await this.loadData();\n\n      this.addRows(data);\n      this.isRequestSend = false;\n    }\n  };\n\n  constructor(header = [], { url = '', step = 30, start = 0, isSortLocally = false } = {}) {\n    this.header = header;\n    this.url = new URL(url, process.env.BACKEND_URL);\n    this.step = step;\n    this.sortParams._sort = header.find(item => item.sortable).id;\n    this.sortParams._order = 'asc';\n    this.sortParams._start = start;\n    this.sortParams._end = start + step;\n    this.isSortLocally = isSortLocally;\n\n    this.render();\n    this.addListeners();\n  }\n\n  get template() {\n    return `\n      <div class=\"sortable-table\">\n\n        <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\n          ${this.getHeaderTemplate()}\n        </div>\n\n        <div data-element=\"body\" class=\"sortable-table__body\">\n          ${this.getBodyTemplate(this.data)}\n        </div>\n\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\n          <div>\n            <p>No products found matching the selected criteria</p>\n            <button data-element=\"reset\" type=\"button\" class=\"button-primary-outline\">Clear filters</button>\n          </div>\n        </div>\n\n      </div>\n    `;\n  }\n\n  getHeaderTemplate() {\n    return this.header.map(item => this.getHeaderRowTemplate(item)).join('');\n  }\n\n  getHeaderRowTemplate({ id, title, sortable }) {\n    return `\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" ${\n      sortable ? 'data-order=\"asc\"' : ''\n    }>\n        <span>${title}</span>\n        ${this.getHeaderArrowTemplate(id)}\n      </div>\n    `;\n  }\n\n  getHeaderArrowTemplate(id) {\n    const template = `\n      <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n        <span class=\"sort-arrow\"></span>\n      </span>\n    `;\n\n    return id === this.sortParams._sort ? template : '';\n  }\n\n  getBodyTemplate(data) {\n    return data\n      .map(item => {\n        return `\n          <a href=\"/products/${item.id}\" class=\"sortable-table__row\">\n            ${this.getCellTemplate(item)}\n          </a>\n        `;\n      })\n      .join('');\n  }\n\n  getCellTemplate(item) {\n    return this.header\n      .map(({ id, template }) => {\n        if (id === 'images' && !item[id].length) {\n          return `\n            <div class=\"sortable-table__cell\">\n              <img class=\"sortable-table-image\" alt=\"no-image\" src=\"#\">\n            </div>\n          `;\n        } else if (template) {\n          return template(item[id]);\n        } else {\n          return `<div class=\"sortable-table__cell\">${item[id]}</div>`;\n        }\n      })\n      .join('');\n  }\n\n  async render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(this.element);\n\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  getSubElements(element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((acc, subElement) => {\n      acc[subElement.dataset.element] = subElement;\n\n      return acc;\n    }, {});\n  }\n\n  async loadData(params) {\n    this.element.classList.add('sortable-table_loading');\n\n    if (params) {\n      this.filterParams = params;\n    }\n\n    const url = new URL(this.url);\n    const query = Object.assign({}, this.filterParams, this.sortParams);\n\n    for (const key of Object.keys(query)) {\n      url.searchParams.set(key, query[key]);\n    }\n\n    const data = await fetchJson(url);\n\n    this.element.classList.remove('sortable-table_loading');\n\n    return data;\n  }\n\n  update(data) {\n    if (data.length) {\n      this.subElements.body.innerHTML = this.getBodyTemplate(data);\n      this.data = data;\n      this.element.classList.remove('sortable-table_empty');\n    } else {\n      this.element.classList.add('sortable-table_empty');\n    }\n  }\n\n  makeSort(field, order) {\n    const arr = [...this.data];\n    const { sortType } = this.header.find(item => item.id === field);\n    const direction = order === 'asc' ? 1 : -1;\n\n    return arr.sort((a, b) => {\n      switch (sortType) {\n        case 'string':\n          return direction * a[field].localeCompare(b[field], ['ru', 'en'], { caseFirst: 'upper' });\n        case 'number':\n          return direction * (a[field] - b[field]);\n        default:\n          return direction * (a[field] - b[field]);\n      }\n    });\n  }\n\n  sort(field, order) {\n    const sortedData = this.makeSort(field, order);\n\n    this.subElements.body.innerHTML = this.getBodyTemplate(sortedData);\n  }\n\n  async sortOnServer() {\n    const data = await this.loadData();\n\n    this.update(data);\n  }\n\n  addListeners() {\n    this.subElements.header.addEventListener('click', this.onHeaderPointerdown);\n    document.addEventListener('scroll', this.onDocumentScroll);\n  }\n\n  addRows(data) {\n    this.subElements.body.insertAdjacentHTML('beforeend', this.getBodyTemplate(data));\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n    this.subElements = {};\n    document.removeEventListener('scroll', this.onDocumentScroll);\n  }\n}\n","export default class RangePicker {\n  element = null;\n  subElements = {};\n  selectingFrom = true;\n  selected = {\n    from: new Date(),\n    to: new Date()\n  };\n\n  static formatDate(date) {\n    return date.toLocaleString('ru', { dateStyle: 'short' });\n  }\n\n  onDocumentClick = event => {\n    const isOpen = this.element.classList.contains('rangepicker_open');\n    const isRangePicker = this.element.contains(event.target);\n\n    if (isOpen && !isRangePicker) {\n      this.close();\n    }\n  };\n\n  constructor({ from = new Date(), to = new Date() } = {}) {\n    this.showDateFrom = new Date(from);\n    this.selected = { from, to };\n\n    this.render();\n  }\n\n  get template() {\n    const from = RangePicker.formatDate(this.selected.from);\n    const to = RangePicker.formatDate(this.selected.to);\n\n    return `<div class=\"rangepicker\">\n      <div class=\"rangepicker__input\" data-element=\"input\">\n        <span data-element=\"from\">${from}</span> -\n        <span data-element=\"to\">${to}</span>\n      </div>\n      <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\n    </div>`;\n  }\n\n  render() {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    this.subElements = this.getSubElements(element);\n\n    this.initEventListeners();\n  }\n\n  getSubElements(element) {\n    const subElements = {};\n\n    for (const subElement of element.querySelectorAll('[data-element]')) {\n      subElements[subElement.dataset.element] = subElement;\n    }\n\n    return subElements;\n  }\n\n  initEventListeners() {\n    const { input, selector } = this.subElements;\n\n    document.addEventListener('click', this.onDocumentClick, true);\n    input.addEventListener('click', () => this.toggle());\n    selector.addEventListener('click', event => this.onSelectorClick(event));\n  }\n\n  toggle() {\n    this.element.classList.toggle('rangepicker_open');\n    this.renderDateRangePicker();\n  }\n\n  onSelectorClick({ target }) {\n    if (target.classList.contains('rangepicker__cell')) {\n      this.onRangePickerCellClick(target);\n    }\n  }\n\n  close() {\n    this.element.classList.remove('rangepicker_open');\n  }\n\n  renderDateRangePicker() {\n    const showDate1 = new Date(this.showDateFrom);\n    const showDate2 = new Date(this.showDateFrom);\n    const { selector } = this.subElements;\n\n    showDate2.setMonth(showDate2.getMonth() + 1);\n\n    selector.innerHTML = `\n      <div class=\"rangepicker__selector-arrow\"></div>\n      <div class=\"rangepicker__selector-control-left\"></div>\n      <div class=\"rangepicker__selector-control-right\"></div>\n      ${this.renderCalendar(showDate1)}\n      ${this.renderCalendar(showDate2)}\n    `;\n\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\n\n    controlLeft.addEventListener('click', () => this.prev());\n    controlRight.addEventListener('click', () => this.next());\n\n    this.renderHighlight();\n  }\n\n  prev() {\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\n    this.renderDateRangePicker();\n  }\n\n  next() {\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\n    this.renderDateRangePicker();\n  }\n\n  renderHighlight() {\n    const { from, to } = this.selected;\n\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\n      const { value } = cell.dataset;\n      const cellDate = new Date(value);\n\n      cell.classList.remove('rangepicker__selected-from');\n      cell.classList.remove('rangepicker__selected-between');\n      cell.classList.remove('rangepicker__selected-to');\n\n      if (from && value === from.toISOString()) {\n        cell.classList.add('rangepicker__selected-from');\n      } else if (to && value === to.toISOString()) {\n        cell.classList.add('rangepicker__selected-to');\n      } else if (from && to && cellDate >= from && cellDate <= to) {\n        cell.classList.add('rangepicker__selected-between');\n      }\n    }\n\n    if (from) {\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\n      if (selectedFromElem) {\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\n      }\n    }\n\n    if (to) {\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\n      if (selectedToElem) {\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\n      }\n    }\n  }\n\n  renderCalendar(showDate) {\n    const date = new Date(showDate);\n    const getGridStartIndex = dayIndex => {\n      const index = dayIndex === 0 ? 6 : dayIndex - 1; // make Sunday (0) the last day\n      return index + 1;\n    };\n\n    date.setDate(1);\n\n    // text-transform: capitalize\n    const monthStr = date.toLocaleString('ru', { month: 'long' });\n\n    let table = `<div class=\"rangepicker__calendar\">\n      <div class=\"rangepicker__month-indicator\">\n        <time datetime=${monthStr}>${monthStr}</time>\n      </div>\n      <div class=\"rangepicker__day-of-week\">\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\n      </div>\n      <div class=\"rangepicker__date-grid\">\n    `;\n\n    // first day of month starts after a space\n    // * * * 1 2 3 4\n    table += `\n      <button type=\"button\"\n        class=\"rangepicker__cell\"\n        data-value=\"${date.toISOString()}\"\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\n          ${date.getDate()}\n      </button>`;\n\n    date.setDate(2);\n\n    while (date.getMonth() === showDate.getMonth()) {\n      table += `\n        <button type=\"button\"\n          class=\"rangepicker__cell\"\n          data-value=\"${date.toISOString()}\">\n            ${date.getDate()}\n        </button>`;\n\n      date.setDate(date.getDate() + 1);\n    }\n\n    // close the table\n    table += '</div></div>';\n\n    return table;\n  }\n\n  onRangePickerCellClick(target) {\n    const { value } = target.dataset;\n\n    if (value) {\n      const dateValue = new Date(value);\n\n      if (this.selectingFrom) {\n        this.selected = {\n          from: dateValue,\n          to: null\n        };\n        this.selectingFrom = false;\n        this.renderHighlight();\n      } else {\n        if (dateValue > this.selected.from) {\n          this.selected.to = dateValue;\n        } else {\n          this.selected.to = this.selected.from;\n          this.selected.from = dateValue;\n        }\n\n        this.selectingFrom = true;\n        this.renderHighlight();\n      }\n\n      if (this.selected.from && this.selected.to) {\n        this.dispatchEvent();\n        this.close();\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to);\n      }\n    }\n  }\n\n  dispatchEvent() {\n    this.element.dispatchEvent(\n      new CustomEvent('date-select', {\n        bubbles: true,\n        detail: this.selected\n      })\n    );\n  }\n\n  remove() {\n    this.element.remove();\n    // TODO: Warning! To remove listener MUST be passes the same event phase\n    document.removeEventListener('click', this.onDocumentClick, true);\n  }\n\n  destroy() {\n    this.remove();\n    this.element = null;\n    this.subElements = {};\n    this.selectingFrom = true;\n    this.selected = {\n      from: new Date(),\n      to: new Date()\n    };\n\n    return this;\n  }\n}\n"],"sourceRoot":""}